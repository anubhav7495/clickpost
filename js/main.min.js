jQuery(document).ready(function(e){function t(t){t.each(function(){var t=e(this),l={};l.timelineWrapper=t.find(".events-wrapper"),l.eventsWrapper=l.timelineWrapper.children(".events"),l.fillingLine=l.eventsWrapper.children(".filling-line"),l.timelineEvents=l.eventsWrapper.find("a"),l.timelineNavigation=t.find(".timeline-navigation"),l.eventsContent=t.children(".events-content");var o=a(l);l.eventsWrapper.css("width",o+"px"),r(l.eventsWrapper.find("a.selected"),l.fillingLine,o),s("next",l.eventsWrapper.find("a.selected"),l),e(".loader").hide(),t.addClass("loaded"),l.timelineNavigation.on("click",".next",function(e){e.preventDefault(),n(l,o,"next")}),l.timelineNavigation.on("click",".prev",function(e){e.preventDefault(),n(l,o,"prev")}),l.eventsWrapper.on("click","a",function(t){t.preventDefault(),l.timelineEvents.removeClass("selected"),e(this).addClass("selected"),c(e(this)),r(e(this),l.fillingLine,o),p(e(this),l.eventsContent)}),e(document).keyup(function(e){"37"==e.which&&f(t.get(0))?i(l,o,"prev"):"39"==e.which&&f(t.get(0))&&i(l,o,"next")})})}function n(e,t,n){var i=o(e.eventsWrapper),a=Number(e.timelineWrapper.css("width").replace("px",""));"next"==n?l(e,i-a+h,a-t):l(e,i+a-h)}function i(e,t,n){var i=e.eventsContent.find(".selected"),a="next"==n?i.next():i.prev();if(a.length>0){var l=e.eventsWrapper.find(".selected"),o="next"==n?l.parent("li").next("li").children("a"):l.parent("li").prev("li").children("a");r(o,e.fillingLine,t),p(o,e.eventsContent),o.addClass("selected"),l.removeClass("selected"),c(o),s(n,o,e)}}function a(t){var n=t.timelineEvents.length;h=e(".events-wrapper").width()/n>h?e(".events-wrapper").width()/n:h;for(var i=0;n>i;i++)t.timelineEvents.eq(i).css("left",i*h+"px");return h*n}function r(e,t,n){var i=window.getComputedStyle(e.get(0),null),a=i.getPropertyValue("left"),r=i.getPropertyValue("width");a=Number(a.replace("px",""))+Number(r.replace("px",""))/2;var s=a/n;d(t.get(0),"scaleX",s)}function s(e,t,n){var i=window.getComputedStyle(t.get(0),null),a=Number(i.getPropertyValue("left").replace("px","")),r=Number(n.timelineWrapper.css("width").replace("px","")),s=Number(n.eventsWrapper.css("width").replace("px","")),p=o(n.eventsWrapper);("next"==e&&a>r-p||"prev"==e&&-p>a)&&l(n,-a+r/2,r-s)}function l(e,t,n){var i=e.eventsWrapper.get(0);t=t>0?0:t,t="undefined"!=typeof n&&n>t?n:t,d(i,"translateX",t+"px"),0==t?e.timelineNavigation.find(".prev").addClass("inactive"):e.timelineNavigation.find(".prev").removeClass("inactive"),t==n?e.timelineNavigation.find(".next").addClass("inactive"):e.timelineNavigation.find(".next").removeClass("inactive")}function o(e){var t=window.getComputedStyle(e.get(0),null),n=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform");if(n.indexOf("(")>=0){var n=n.split("(")[1];n=n.split(")")[0],n=n.split(",");var i=n[4]}else var i=0;return Number(i)}function p(e,t){var n=e.data("pos"),i=t.find(".selected"),a=t.find('[data-pos="'+n+'"]'),r=a.height();if(a.index()>i.index())var s="selected enter-right",l="leave-left";else var s="selected enter-left",l="leave-right";a.attr("class",s),i.attr("class",l).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){i.removeClass("leave-right leave-left"),a.removeClass("enter-left enter-right")}),t.css("height",r+"px")}function d(e,t,n){e.style["-webkit-transform"]=t+"("+n+")",e.style["-moz-transform"]=t+"("+n+")",e.style["-ms-transform"]=t+"("+n+")",e.style["-o-transform"]=t+"("+n+")",e.style.transform=t+"("+n+")"}function c(e){e.parent("li").prevAll("li").children("a").addClass("older-event").end().end().nextAll("li").children("a").removeClass("older-event")}function f(e){for(var t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,a=e.offsetHeight;e.offsetParent;)e=e.offsetParent,t+=e.offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+a>window.pageYOffset&&n+i>window.pageXOffset}function v(e){e.scans.sort(function(e,t){return new Date(e.timestamp)-new Date(t.timestamp)})}function u(e){var t=new Date(e);return t.toString()}function m(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null==t?null:t[1]||0}var g="https://www.clickpost.in/api/v2/track-order/",h=120,w={username:"testuser",key:"2e9b19ac-8e1f-41ac-a35b-4cd23f41ae17"};w.waybill=parseInt(m("waybill"))||3515341,w.cp_id=parseInt(m("cp_id"))||10,e.getJSON(g,w,function(n){var i=n.result[w.waybill.toString()],a=[],r=[],s=e(".horizontal-timeline");v(i);for(var l=0;l<i.scans.length;l++)a.push('<li><a data-pos="'+l+'">'+i.scans[l].clickpost_status_description+"</a></li>"),r.push('<li data-pos="'+l+'"><h2>'+i.scans[l].clickpost_status_description+"</h2><em>"+u(i.scans[l].timestamp)+'</em><p><span class="text-bold">Status:</span>&nbsp;'+i.scans[l].remark+'<br><span class="text-bold">Current Location:</span>&nbsp;'+i.scans[l].location+"</p></li>");e(".events ol").append(a),e(".events-content ol").append(r),e(".events ol li a").last().addClass("selected"),e(".events-content ol li").last().addClass("selected"),s.length>0&&t(s)})});